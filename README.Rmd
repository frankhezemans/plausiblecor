---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "50%",
  out.height = "20%"
)
```

# plausiblecor: Bayesian Post-Hoc Correlation Analysis with Plausible Values

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
<!-- badges: end -->

The R package `plausiblecor` provides tools to test correlations between estimated latent parameters and observed covariates. It implements a *plausible values* approach (Ly et al., 2017) that properly accounts for uncertainty, enabling Bayesian inference on the correlation coefficient at both the sample and population level, without the need to re-fit the latent variable model. This is achieved through established methods for obtaining a posterior distribution based solely on an observed correlation coefficient and sample size (Ly et al., 2018; Kucharský et al., 2023; Van Doorn et al., 2018).

The package includes functions for calculating, summarising, visualising, and comparing plausible correlations.

## Statement of need

To the best of our knowledge, this methodology has so far only been (partially) implemented in two open-source tools: the Dynamic Models of Choice ([`DMC`](https://osf.io/pbwx8/)) toolbox (Heathcote et al., 2019), and the [`TreeBUGS`](https://github.com/danheck/TreeBUGS) R package (Heck et al., 2018). In both cases, plausible values correlation analysis was included only as an ancillary feature, tied to specific modelling frameworks and software: `DMC` focuses on models of speeded decision-making and response inhibition; `TreeBUGS` focuses on multinomial processing tree models and requires the JAGS MCMC library.

In contrast, `plausiblecor` offers a more **modular and model-agnostic approach**. It works directly with arbitrary data frames of MCMC samples and covariates, providing a compact, self-contained workflow for plausible values correlation analysis with flexible tools for summarisation and visualisation. Multiple correlation types (Pearson's *r* or Kendall's *tau*) and alternative hypotheses (two-sided, strictly non-negative or non-positive) are supported.

## Installation

You can install the development version of `plausiblecor` as follows:

``` r
remotes::install_github("frankhezemans/plausiblecor")
```

## Getting started

`plausiblecor` ships with example MCMC samples and covariates based on data from Forstmann et al. (2008), who tested the effect of a speed/accuracy manipulation on speeded decision-making in conjunction with functional neuroimaging (fMRI).

The following illustrates how to analyse the correlation between a latent parameter (estimated change in response caution) and an observed covariate (fMRI BOLD signal change in the caudate nucleus):

```{r basic_example}
library(plausiblecor)

# correlation between latent parameter and fMRI signal in the striatum
caution_striatum_cor <- run_plausible_cor(
  parameter = "caution_effect_speed",
  covariate = "striatum",
  mcmc_data = Forstmann_LBA,
  covariate_data = Forstmann_fMRI
)

# summarise the result at both the sample and population level
summary(caution_striatum_cor, rope_range = c(-0.1, 0.1))

# illustrate the posterior distribution at the population level
plot(caution_striatum_cor)
```

## Development status

This package is under **active development**. Some functions are experimental and may change drastically or be removed without notice. If you use this package, please be prepared to update your code as the package develops. Feedback is very welcome via [GitHub issues](https://github.com/frankhezemans/plausiblecor/issues).

## References

Forstmann, B. U., et al. (2008). Striatum and pre-SMA facilitate decision-making under time pressure. *Proceedings of the National Academy of Sciences*, *105*(45), 17538–17542. DOI: [10.1073/pnas.0805903105](https://doi.org/10.1073/pnas.0805903105)

Heathcote, A., Lin, Y. S., Reynolds, A., Strickland, L., Gretton, M., & Matzke, D. (2019). Dynamic models of choice. *Behavior Research Methods*, *51*(2), 961–985. DOI: [10.3758/s13428-018-1067-y](https://doi.org/10.3758/s13428-018-1067-y)

Heck, D. W., Arnold, N. R., & Arnold, D. (2018). TreeBUGS: An R package for hierarchical multinomial-processing-tree modeling. *Behavior Research Methods*, *50*, 264–284. DOI: [10.3758/s13428-017-0869-7](https://doi.org/10.3758/s13428-017-0869-7)

Ly, A., Boehm, U., Heathcote, A., Turner, B. M., Forstmann, B., Marsman, M., & Matzke, D. (2017). A flexible and efficient hierarchical Bayesian approach to the exploration of individual differences in cognitive‐model‐based neuroscience. In A. A. Moustafa (Ed.),  *Computational Models of Brain and Behavior* (pp. 467–479). Wiley. DOI: [10.1002/9781119159193.ch34](https://doi.org/10.1002/9781119159193.ch34)

Ly, A., Marsman, M., & Wagenmakers, E.-J. (2018). Analytic posteriors for Pearson's correlation coefficient. *Statistica Neerlandica*, *72*, 4–13. DOI: [10.1111/stan.12111](https://doi.org/10.1111/stan.12111)

Kucharský, S., Wagenmakers, E.-J., Van den Bergh, D., & Ly, A. (2023). Analytic posterior distributions and Bayes Factor for Pearson Partial Correlation. *PsyArXiv Preprints*. DOI: [10.31234/osf.io/6muwy](https://doi.org/10.31234/osf.io/6muwy)

Van Doorn, J., Ly, A., Marsman, M., & Wagenmakers, E.-J. (2018). Bayesian inference for Kendall's rank correlation coefficient. *The American Statistician*, *72*, 303-308. DOI: [10.1080/00031305.2016.1264998](https://doi.org/10.1080/00031305.2016.1264998)
